# 機能要件定義書

## 1. プロジェクト概要

### アプリケーション名
**ポチポチ** - 夫婦向け家計簿アプリ

### 目的
夫婦での支出管理を効率化し、手入力を極力減らしながら予算管理を行う

### 対象ユーザー
- 夫婦
- ITリテラシー：シンプルで直感的な操作を好む
- 利用シーン：買い物直後にその場で入力

## 2. 基本機能要件

### 2.1 支出管理機能
- **支出登録**
  - 金額、日付、カテゴリ、サブカテゴリ、メモの登録
  - 手動入力とクレジットカード利用履歴からの自動取込
  - 夫婦それぞれが登録可能

- **支出一覧表示**
  - 日別、月別での支出一覧表示
  - カテゴリ・サブカテゴリでの絞り込み
  - 検索機能（金額、メモ、日付範囲）

- **カレンダー画面での支出管理**
  - 月間カレンダービューでの支出確認
  - 任意の日付での支出入力
  - 日別支出詳細の表示
  - 支出データ選択による編集機能

- **支出編集・削除**
  - 登録済み支出の編集・削除機能
  - カレンダーからの直接編集
  - 入力画面と同じUIでの編集

### 2.2 カテゴリ管理機能
- **カテゴリ・サブカテゴリ設定**
  - 初期カテゴリ：食費（外食、食材）、娯楽（旅行、遊び）
  - カテゴリ・サブカテゴリの追加、編集、削除
  - 階層構造の管理（カテゴリ > サブカテゴリ）

### 2.3 予算管理機能
- **予算設定**
  - 月単位での予算設定
  - カテゴリごとの個別予算設定
  - 全体予算の設定

- **予算監視・通知**
  - 予算超過時の通知機能
  - 予算残高の表示
  - 予算達成率の表示

### 2.4 レポート・分析機能
- **グラフ表示**
  - 月ごとの支出推移グラフ
  - カテゴリ別支出の円グラフ
  - 予算vs実績の比較表示（カテゴリごと・全体）

- **統計情報**
  - 月間支出合計
  - カテゴリ別支出統計
  - 前月比較

### 2.5 データ取込機能（必須）
- **メール通知からの自動取得**
  - VPASS利用通知メールの自動解析
  - n8nによるGmail API連携
  - 利用日時、店舗、金額の自動抽出
  - リアルタイム通知による即座のデータ取込
  - 取得データの重複チェック機能
  - 取込データの自動カテゴリ分類機能（学習機能）
  
- **メール解析機能**
  - 正規表現によるデータ抽出
  - メール形式変更への対応
  - 解析失敗時の手動確認機能
  - 家族カード利用者の識別（メール内容から推定）

## 3. 対応デバイス・プラットフォーム

### 3.1 対応デバイス
- **スマートフォン**（メイン利用）
  - 買い物直後の即座入力に対応
  - レスポンシブデザインでの最適化

- **PC**（詳細確認・分析用）
  - より詳細なレポート表示
  - 一括データ管理

### 3.2 データ同期
- クラウドベースでのデータ保存
- リアルタイム同期により、どのデバイスからでも最新データにアクセス

## 4. ユーザビリティ要件

### 4.1 操作性
- シンプルで直感的なUI/UX
- 最小限のタップ・クリックで操作完了
- 買い物直後の短時間入力を重視

### 4.2 応答性
- 支出登録：3秒以内で完了
- 画面遷移：1秒以内
- データ同期：リアルタイム

## 5. 優先度分類

### 高優先度（MVP機能）
- 支出登録・一覧表示
- 基本的なカテゴリ管理
- 月次予算設定・監視
- スマートフォン対応
- ホーム画面（支出入力画面）
- カレンダー画面での支出確認・入力

### 中優先度（必須機能）
- **メール通知からの自動取得（n8n + Gmail API）**
- 詳細レポート・グラフ機能
- PC対応
- 予算超過通知
- 自動カテゴリ分類機能

### 低優先度（将来機能）
- 決済方法管理
- 高度な分析機能
- 他のクレジットカード連携